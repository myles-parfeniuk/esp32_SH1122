\chapter{README}
\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e}{}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e}\index{README@{README}}
Table of Contents.

\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_readme-top}%
\Hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_readme-top}%
 


\begin{DoxyEnumerate}
\item \href{\#about}{\texttt{ About}}  
\item \href{\#features}{\texttt{ Features}} 
\begin{DoxyItemize}
\item \href{\#custom-bitmaps}{\texttt{ Custom Bitmaps}} 
\item \href{\#u8g2-font-support}{\texttt{ U8\+G2 Font Support}} 
\item \href{\#screenshots}{\texttt{ Screenshots}} 
\end{DoxyItemize}
\item \href{\#getting-started}{\texttt{ Getting Started}} 
\begin{DoxyItemize}
\item \href{\#wiring}{\texttt{ Wiring}} 
\item \href{\#adding-to-project}{\texttt{ Adding to Project}} 
\item \href{\#example}{\texttt{ Example}} 
\item \href{\#creating-bitmaps}{\texttt{ Creating Bitmaps}} 
\item \href{\#font-system}{\texttt{ Font System}} 
\item \href{\#taking-screenshots}{\texttt{ Taking Screenshots}} 
\end{DoxyItemize}
\item \href{\#documentation}{\texttt{ Documentation}} 
\item \href{\#acknowledgements}{\texttt{ Acknowledgements}} 
\item \href{\#license}{\texttt{ License}} 
\item \href{\#contact}{\texttt{ Contact}} 
\end{DoxyEnumerate}\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md0}{}\doxysubsection{\texorpdfstring{About}{About}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md0}
esp32\+\_\+\+SH1122 is a C++ esp-\/idf v5.\+x component, intended to serve as a driver for SH1122 driven 256x64 OLED displays with 16 shades of grayscale. ~\newline
 This library contains functions for basic graphics like lines, rectangles, and ellipses. It also contains support for strings and bitmaps. ~\newline
\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md1}{}\doxysubsection{\texorpdfstring{Features}{Features}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md1}
(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md2}{}\doxysubsubsection{\texorpdfstring{Custom Bitmaps}{Custom Bitmaps}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md2}
This library includes tools for encoding images into 16-\/shade grayscale bitmaps. The bitmaps use a custom run-\/length encoding format to minimize memory usage as much as possible. ~\newline


See the Creating Bitmaps for more info.

Below are a few encoded bitmaps on the OLED next to their original source images.

    

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md3}{}\doxysubsubsection{\texorpdfstring{U8\+G2 Font Support}{U8\+G2 Font Support}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md3}
This library contains close to 2000 different fonts from the U8\+G2 display library. ~\newline
 The fonts names remain the same; however, they have "{}sh1122\+\_\+font"{} appended onto the front instead of u8g2\+\_\+font. ~\newline


A list of the fonts available within this library can be found here\+: ~\newline
 \href{https://github.com/olikraus/u8g2/wiki/fntlistall}{\texttt{ https\+://github.\+com/olikraus/u8g2/wiki/fntlistall}} ~\newline


For more on using fonts, see Font System.

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md4}{}\doxysubsubsection{\texorpdfstring{Screenshots}{Screenshots}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md4}
This library contains tools for creating screenshots and gifs for use in documentation. ~\newline


See Taking Screenshots for more info.

Below is an example of screen recording gif displaying a splash screen. ~\newline


 

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md5}{}\doxysubsection{\texorpdfstring{Getting Started}{Getting Started}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md5}
(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md6}{}\doxysubsubsection{\texorpdfstring{Wiring}{Wiring}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md6}
The default wiring is depicted below, it can be changed at driver initialization (see Example).  

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md7}{}\doxysubsubsection{\texorpdfstring{Adding to Project}{Adding to Project}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md7}

\begin{DoxyEnumerate}
\item Create a "{}components"{} directory in the root workspace directory of your esp-\/idf project if it does not exist already. ~\newline


In workspace directory\+: ~\newline
 
\begin{DoxyCode}{0}
\DoxyCodeLine{mkdir\ components}

\end{DoxyCode}

\item Cd into the components directory and clone the esp32\+\_\+\+SH1122 repo.


\begin{DoxyCode}{0}
\DoxyCodeLine{cd\ components}
\DoxyCodeLine{git\ clone\ https://github.com/myles-\/parfeniuk/esp32\_SH1122.git}

\end{DoxyCode}

\item Ensure you clean your esp-\/idf project before rebuilding. ~\newline
 Within esp-\/idf enabled terminal\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{idf.py\ fullclean}

\end{DoxyCode}
 
\end{DoxyEnumerate}

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md8}{}\doxysubsubsection{\texorpdfstring{Example}{Example}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md8}
This example draws a string on a dark gray background. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_s_h1122_oled_8hpp}{SH1122Oled.hpp}}"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}fonts/sh1122\_font\_inr16\_mf.hpp"{}}\ \textcolor{comment}{//include\ any\ fonts\ you\ wish\ to\ use}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{extern}\ \textcolor{stringliteral}{"{}C"{}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{main_8cpp_a630544a7f0a2cc40d8a7fefab7e2fe70}{app\_main}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{class_s_h1122_oled}{SH1122Oled}}\ oled;\ \textcolor{comment}{//using\ default\ initialization}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//custom\ initialization\ example:}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{/*SH1122Oled\ oled(sh1122\_oled\_cfg\_t(SPI3\_HOST,\ //SPI\ peripheral}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPIO\_NUM\_4,\ //sda\ GPIO}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPIO\_NUM\_18,\ //sclk\ GPIO}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPIO\_NUM\_21,\ //chip\ select\ GPIO}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPIO\_NUM\_22,\ //reset\ GPIO}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GPIO\_NUM\_23)\ //data/!command\ GPIO}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}}
\DoxyCodeLine{\textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ load\ font\ for\ drawing\ string}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{class_s_h1122_oled_ab7bcdc3fa8313f91c05d37570816fb17}{SH1122Oled::load\_font}}(sh1122\_font\_inr16\_mf);\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{while}\ (1)}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ oled.\mbox{\hyperlink{class_s_h1122_oled_ae9c9bf415c7848c01e52596556a3bb6e}{clear\_buffer}}();\ \textcolor{comment}{//\ clear\ buffer\ of\ previous\ frame\ before\ drawing}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ draw\ background}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ oled.\mbox{\hyperlink{class_s_h1122_oled_a6102a5313bff0ba8a4725b803309789c}{draw\_rectangle}}(0,\ 0,\ \mbox{\hyperlink{class_s_h1122_oled_a19a266d7e191a80f5aa3830f061523cd}{SH1122Oled::WIDTH}},\ \mbox{\hyperlink{class_s_h1122_oled_a2262e8942e3aac1dfd2b01220a2fc7d4}{SH1122Oled::HEIGHT}},\ \mbox{\hyperlink{class_s_h1122_oled_ad8b515d4fef52e11ed035cc7b29d5fe4ac98a679441798bdb9c194f9ca471e6cd}{SH1122Oled::PixelIntensity::level\_1}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ draw\ screen\ border}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ oled.\mbox{\hyperlink{class_s_h1122_oled_a12600c4d2c22996c87be1446989bf7d0}{draw\_rectangle\_frame}}(0,\ 0,\ \mbox{\hyperlink{class_s_h1122_oled_a19a266d7e191a80f5aa3830f061523cd}{SH1122Oled::WIDTH}},\ \mbox{\hyperlink{class_s_h1122_oled_a2262e8942e3aac1dfd2b01220a2fc7d4}{SH1122Oled::HEIGHT}},\ 2,\ \mbox{\hyperlink{class_s_h1122_oled_ad8b515d4fef52e11ed035cc7b29d5fe4a8e43ab279ebe8f429fcd78d6118a535e}{SH1122Oled::PixelIntensity::level\_10}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ draw\ the\ string}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ x\ =\ oled.\mbox{\hyperlink{class_s_h1122_oled_a2e1585db0fd1b9fcb92c561405cbcc72}{font\_get\_string\_center\_x}}(\textcolor{stringliteral}{"{}esp32\_SH1122"{}});\ \ \textcolor{comment}{//\ find\ the\ string\ x\ position\ for\ horizontal\ centering}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ y\ =\ oled.\mbox{\hyperlink{class_s_h1122_oled_a469839045764fccd33cf3483ce1d2447}{font\_get\_string\_center\_y}}(\textcolor{stringliteral}{"{}esp32\_SH1122"{}});\ \ \textcolor{comment}{//\ find\ the\ string\ y\ position\ for\ vertical\ centering}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ oled.\mbox{\hyperlink{class_s_h1122_oled_afe2872705b72dfb528bd0832a89fc58a}{draw\_string}}(x,\ y,\ \mbox{\hyperlink{class_s_h1122_oled_ad8b515d4fef52e11ed035cc7b29d5fe4a823f22afd79716eecd814bcc35a68f00}{SH1122Oled::PixelIntensity::level\_15}},\ \textcolor{stringliteral}{"{}esp32\_SH1122"{}});\ }
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ oled.\mbox{\hyperlink{class_s_h1122_oled_adc65debb1bc5cfc1d999e26d82a50c11}{update\_screen}}();\ \textcolor{comment}{//\ send\ the\ current\ buffer\ to\ the\ screen}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ vTaskDelay(50\ /\ portTICK\_PERIOD\_MS);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\}}

\end{DoxyCode}
 

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md9}{}\doxysubsubsection{\texorpdfstring{Creating Bitmaps}{Creating Bitmaps}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md9}
To create bitmaps\+:


\begin{DoxyEnumerate}
\item Place .png images into the {\ttfamily python\+\_\+utilities/bitmap\+\_\+encoder/input} directory.
\item Run the {\ttfamily sh1122\+\_\+encode\+\_\+bitmap.\+py} script and append any arguments on you see fit. ~\newline


From terminal with python in path\+:

{\ttfamily sh python sh1122\+\_\+encode\+\_\+bitmap.\+py }

To see a full list of argument flags type\+: {\ttfamily sh python sh1122\+\_\+encode\+\_\+bitmap.\+py -\/help }
\item Copy the .hpp files generated by the script from {\ttfamily python\+\_\+utilities/bitmap\+\_\+encoder/output} to {\ttfamily your\+\_\+project/components/esp32\+\_\+\+SH1122/bitmaps}
\item To draw a bitmap include the respective .hpp file at the top of your project and call draw bitmap. 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_s_h1122_oled_8hpp}{SH1122Oled.hpp}}"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}bitmaps/sh1122\_bitmap\_your\_file.hpp"{}}}
\DoxyCodeLine{\textcolor{comment}{//...}}
\DoxyCodeLine{\textcolor{comment}{//somewhere\ in\ your\ code}}
\DoxyCodeLine{oled.\mbox{\hyperlink{class_s_h1122_oled_aa8af3daa933bda16bcf067f8db12f78b}{draw\_bitmap}}(0,\ 0,\ sh1122\_bitmap\_your\_file);}

\end{DoxyCode}
 
\end{DoxyEnumerate}

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md10}{}\doxysubsubsection{\texorpdfstring{Font System}{Font System}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md10}
All the font files are located within the {\ttfamily fonts/} directory. Ensure you load a font before calling functions like {\ttfamily draw\+\_\+string()}, {\ttfamily draw\+\_\+glyph()}, {\ttfamily get\+\_\+string\+\_\+width()}, etc... ~\newline


A full list of included fonts can be found at\+: ~\newline
 \href{https://github.com/olikraus/u8g2/wiki/fntlistall}{\texttt{ https\+://github.\+com/olikraus/u8g2/wiki/fntlistall}}

To use a font\+:


\begin{DoxyEnumerate}
\item Include the respective font\textquotesingle{}s header file at the top of your file\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ "{}fonts/sh1122\_font\_inr16\_mf.hpp"{}}}

\end{DoxyCode}

\item Call load\+\_\+font(), passing it the font look up table\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{class_s_h1122_oled_ab7bcdc3fa8313f91c05d37570816fb17}{SH1122Oled::load\_font}}(sh1122\_font\_inr16\_mf);\ }

\end{DoxyCode}

\item Call whichever draw functions you like, for example\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{oled.\mbox{\hyperlink{class_s_h1122_oled_afe2872705b72dfb528bd0832a89fc58a}{draw\_string}}(x,\ y,\ \mbox{\hyperlink{class_s_h1122_oled_ad8b515d4fef52e11ed035cc7b29d5fe4a823f22afd79716eecd814bcc35a68f00}{SH1122Oled::PixelIntensity::level\_15}},\ \textcolor{stringliteral}{"{}my\ string"{}});\ }

\end{DoxyCode}
 String functions also support variable argument lists like printf\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int}\ my\_number\ =\ 1122;}
\DoxyCodeLine{oled.\mbox{\hyperlink{class_s_h1122_oled_afe2872705b72dfb528bd0832a89fc58a}{draw\_string}}(x,\ y,\ \mbox{\hyperlink{class_s_h1122_oled_ad8b515d4fef52e11ed035cc7b29d5fe4a823f22afd79716eecd814bcc35a68f00}{SH1122Oled::PixelIntensity::level\_15}},\ \textcolor{stringliteral}{"{}my\ number\ \%d"{}},\ my\_number);\ }

\end{DoxyCode}
 

(\href{\#readme-top}{\texttt{ back to top}})
\end{DoxyEnumerate}\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md11}{}\doxysubsubsection{\texorpdfstring{Taking Screenshots}{Taking Screenshots}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md11}
To take screen shots\+:


\begin{DoxyEnumerate}
\item Call the take\+\_\+screenshot() method somewhere in your firmware, this function dumps the current frame buffer over serial. \`{}\`{}{\ttfamily cpp oled.\+take\+\_\+screen\+\_\+shot() @icode}
\item {\ttfamily While your firmware is flashed and executing, run the}sh1122\+\_\+screenshot.\+py{\ttfamily script located in}python\+\_\+utilities/screenshot\`{}. Ensure you close the esp-\/idf serial monitor if you have it open and append the comport name as well as baud rate onto the script execution call, for example\+:

sh python sh1122\+\_\+screenshot.\+py COM3 -\/b 115200 \`{}\`{}\`{}
\item The script will display how many screen shots it has captured each time a new one is received, press the q key once you are done to save the images.
\item The output images (in png format) can be found in the {\ttfamily python\+\_\+utilities/screenshot/output} directory. ~\newline

\end{DoxyEnumerate}

{\bfseries{NOTE\+:}} ~\newline
 For minimal latency you should increase your console baud rate in menuconfig to the maximum possible value. ~\newline
 For more info see the header at the top of sh1122\+\_\+screenshot.\+py. ~\newline


To create gifs from any captured screenshots simply run {\ttfamily sh1122\+\_\+gif\+\_\+creator.\+py}, it will account for each frame duration according to the time stamps in the filenames of the screenshots.

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md12}{}\doxysubsection{\texorpdfstring{Documentation}{Documentation}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md12}
API documentation generated with doxygen can be found in the documentation directory of the master branch. ~\newline
 

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md13}{}\doxysubsection{\texorpdfstring{Acknowledgements}{Acknowledgements}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md13}
Thanks to Oliver Krause and contributors of u8g2. ~\newline
 \href{https://github.com/olikraus/u8g2}{\texttt{ https\+://github.\+com/olikraus/u8g2}} ~\newline
 This library utilizes the same run-\/line encoding system used by U8\+G2 for fonts. ~\newline
 

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md14}{}\doxysubsection{\texorpdfstring{License}{License}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md14}
Distributed under the MIT License. See {\ttfamily LICENSE.\+md} for more information. 

(\href{\#readme-top}{\texttt{ back to top}})\hypertarget{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md15}{}\doxysubsection{\texorpdfstring{Contact}{Contact}}\label{md_components_2esp32___s_h1122_2_r_e_a_d_m_e_autotoc_md15}
Myles Parfeniuk -\/ \href{mailto:myles.parfenyuk@gmail.com}{\texttt{ myles.\+parfenyuk@gmail.\+com}}

Project Link\+: \href{https://github.com/myles-parfeniuk/esp32_SH1122.git}{\texttt{ https\+://github.\+com/myles-\/parfeniuk/esp32\+\_\+\+SH1122.\+git}} 

(\href{\#readme-top}{\texttt{ back to top}})